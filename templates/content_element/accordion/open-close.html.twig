{% extends "@Contao/content_element/accordion.html.twig" %}

{% block script %}
  {% add "handorgel_js" to body %}
    {% set script_attributes = attrs()
      .setIfExists('nonce', csp_nonce('script-src'))
      .mergeWith(script_attributes|default)
    %}
    <script src="{{ asset('js/handorgel.min.js', 'contao-components/handorgel') }}"></script>
    <script{{ script_attributes }}>
      (function () {
        const instances = [];

        document.querySelectorAll('.content-accordion').forEach((el) => {
          const acc = new handorgel(el, {
            {% block init_options %}
              multiSelectable: false,
              {# Put custom options here #}
            {% endblock %}
          });

          instances.push(acc);

          acc.on('fold:open', () => {
            instances.forEach((other) => {
              if (other === acc) return;
              other.folds.forEach((f) => f.close());
            });
          });
        });
      })();
    </script>
  {% endadd %}
{% endblock %}
